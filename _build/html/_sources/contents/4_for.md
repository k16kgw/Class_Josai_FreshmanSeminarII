# 繰り返し

出席パスワード：337840

到達目標

- for文とwhile文を理解し，繰り返し処理を行えるようになる．

準備

1. anacondaを使用し，<span style="color:red">jupyter lab</span>を起動する．
2. `Document（書類）/Fresh`フォルダを開き `+` をクリックして新しいファイルを作成する．
3. ファイル名を `4_{学籍番号}_{氏名}.ipynb` に変更する．例：`4_SI25999_香川渓一郎.ipynb`

---

## 導入（第3回の復習）

- **条件分岐（if文）**：条件がTrueかFalseかによって処理を分ける
- 比較演算子：`==`, `!=`, `>`, `<`, `>=`, `<=`
- 論理演算子：`and`, `or`, `not`
- 例外処理：`try` / `except`
- 入力チェック：`int(input())` で整数化し、ValueErrorを捕捉

```{note}
**演習4**  

うるう年は次のルールに基づいて決められる．これを元に`year`の年が「うるう年」かそれ以外の「平年」かを出力するプログラムを実装せよ．

- 4で割り切れる年はうるう年
- ただし100で割り切れる年は平年
- ただし400で割り切れる年はうるう年
```

**半答**
```python
year = 2025
if year % 400 == 0:
    print("うるう年")
elif year % 100 == 0:
    print("平年")
elif year % 4 == 0:
    print("うるう年")
else:
    print("平年")
```

論理的には正しいが，`print`の出力を変更する際に，変更箇所が複数あるために変更漏れが起きる可能性がある．
変更箇所は一箇所にしておくとミスが起きにくい．

**完答**
```python
year = 2025
if (year%4==0 and year%100!=0) or year%400==0:
    print("うるう年")
else:
    print("平年")
```

<!-- 
```{note}
**おまけ（時間が余った人）**  

整数 `n` が与えられたとき，`n` が **3の倍数または3のつく数字** ならその数字に「!!!」をつけて表示するプログラムを実装せよ．

例：`n=3`なら`3!!!`，`n=4`なら`4`，`n=13`なら`13!!!`

ヒント：文字列`s`に特定の文字`"a"`が含まれているかを判定するには`"a" in s`とすれば良い．
```
 -->

## 関数

関数：何度も使う処理をひとまとまりにして名前をつけたもの．

メリット
- 同じ処理を何度も書かなくてよい（再利用できる）．
- プログラムが整理されて読みやすくなる．
- 複雑な処理を分割できる（バグを見つけやすくなる）．

基本構文
```python
def 関数名(引数1, 引数2, ...):
    実行したい処理
    return 戻り値
```

例：
```python
def average(a, b):
    result = (a + b) / 2
    return result

x = average(4, 6)
print(x)  # 5.0 と出力される
```

## 繰り返し

同じ処理を**複数回繰り返す**構文を「**繰り返し（ループ）**」という．

### 用途の例

- 同じ計算を複数のデータに対して行う
- 回数を指定して繰り返す
- 入力が正しいまで繰り返す

Pythonには代表的に2種類のループがある：

| 種類       | 使い方                | 指定すること |
| :-------  | :------------        | :---       |
| `for`文    | 決まった回数繰り返す    | 回数        |
| `while`文  | 条件がTrueの間繰り返す  | 条件        |

## for文の基本構文

```python
for 変数 in 繰り返し対象:
    処理
```

例：
```python
for i in [1, 2, 3]:
    print(i)
```

意味：
```
変数`i`へ順に`1`,`2`,`3`を代入しながら，ブロック内の処理 `print(i)` を実行する．
```

出力：
```
1
2
3
```

### range関数と組み合わせ

`range(n)`：`0`から`n-1`までの`n`個の成分を有する整数列を生成する．

```python
for i in range(5):
    print(i)
```

出力：
```
0
1
2
3
4
```

range関数では，`range(開始値, 終了値, 増分)`と指定して配列を作ることができる．
このとき開始値から増やす数を順次加えていき，終了値未満の整数を含む配列を作成する．
増分は指定しない場合には`1`となる．

```python
for i in range(2, 10, 2):
    print(i)
```

出力：
```
2
4
6
8
```

```{warning}
終了値は **含まれない**ことに注意。
```

```{note}
**演習1**  

1. `for`文を用いて`1`から`10`までの整数をすべて出力せよ．  
2. `for`文を用いて`1`から`10`までの偶数だけを出力せよ．  
3. `for`文を用いて`1`から`10`までの整数の合計を求め，`print(f"合計は {total}")`の形で出力せよ．
```

## while文の基本構文

```python
while 条件:
    処理
```

条件がTrueの間ブロック内の処理を繰り返す．
逆に言えば，条件がFalseになるまで繰り返す．
そのため，処理によっては無限ループに入る可能性があることに注意すること．
これを避けるためにブロック内の処理で条件が変わるようにするか，後述の`break`を使う．

例：
```python
count = 0
while count < 5:
    print(count)
    count += 1
```

出力：
```
0
1
2
3
4
```

例：
```python
n = 5
while n > 0:
    print(n)
    n -= 1
print("発射！")
```

出力：
```
5
4
3
2
1
発射！
```

```{note}
**演習2**

1. 1から100までの整数の合計をwhile文で計算せよ．  
2. while文を使って1から100までの偶数のみの合計を求めよ．
```

## break文とcontinue文

### break：ループを途中で抜ける

breakの一つ外側の繰り返し処理を終了する．

例：
```python
for i in range(10):
    if i == 5:
        break
    print(i)
```

出力：
```
0
1
2
3
4
```

### continue：残りの処理をスキップして次の繰り返しへ

continueの一つ外側の繰り返し処理における次の処理に入る．

```python
for i in range(6):
    if i % 2 == 0:
        continue
    print(i)
```

出力：
```
1
3
5
```

```{note}
**演習3**

1. `for i in range(1, 10):`の処理において`continue`を使用し，3の倍数をスキップして出力せよ．
2. `for i in range(1, 10):`の処理において`break`を使い，`5`になったら`5`を出力せずにループを終了せよ．
```

## 入力による繰り返し（while + break）

条件が決まっていない場合，入力値でループを制御する．

```python
while True:
    s = input("整数を入力（qで終了）: ")
    if s == "q":
        break
    try:
        n = int(s)
        print("偶数" if n % 2 == 0 else "奇数")
    except ValueError:
        print("整数を入力してください")
```

- `while True:`：無限ループ（強制的に止める条件が必要）
- `break`で脱出する

## ネストされたループ

for文やif文を入れ子（ネスト）にして複雑な処理を行うことができる．

例：
```python
for i in range(3):
    for j in range(2):
        print(f"i={i}, j={j}")
```

出力：
```
0 0
0 1
1 0
1 1
2 0
2 1
```

```{note}
**演習4**  

九九表を出力せよ（1〜9×1〜9）．
ただし，f-stringを用いて `"1×1=1"` の形式で表示せよ。
```

## for文とリストの活用

リストの要素を変数に順番に代入して繰り返し処理を実行できる．

```python
fruits = ["apple", "banana", "cherry"]
for f in fruits:
    print(f)
```

### enumerate関数（番号付き）

for文では変数を複数回すことができる．

```python
for i, f in enumerate(fruits):
    print(i, f)
```

出力：
```
0 apple
1 banana
2 cherry
```

### zip関数

複数の配列をまとめ，そこから要素を取得してfor文を回すことができる．

```python
subjects = ["国語", "数学", "英語"]
scores   = [80, 70, 90]
for sub, sc in zip(subjects, scores):
    print(f"{sub}: {sc}点")
```

出力
```
国語: 80点
数学: 70点
英語: 90点
```

## まとめ

- 繰り返し処理には **for** と **while** がある．
- **for** は「範囲・回数」で繰り返し，**while** は「条件」で繰り返す．
- `break` で中断，`continue` でスキップする．
- ネストを使って多重ループを書ける．
- 終了条件を忘れると無限ループになる点に注意すること．

### よくあるエラーと注意点

| エラー              | 原因                    | 対策                         |
| :----------------- | :----------------       | :-------------------        |
| `IndentationError` | インデントの不一致         | 4スペースで統一               |
| 無限ループ           | 終了条件を満たさない       | 変数を更新する／`break`を入れる |
| `TypeError`        | `range` に数値以外を渡した | `int()` で型変換する          |
| 出力が多すぎる       | ループ範囲が大きすぎる      | `print`の回数を制御する        |

## 課題

次の2つの課題に取り組み，ipynbファイルを「第4回課題」から提出すること．

```{note}
**課題1**

1から30までの整数について，次の規則に従って出力するプログラムを作れ。  

- 3の倍数のとき `"Fizz"`  
- 5の倍数のとき `"Buzz"`  
- 3と5の両方の倍数のとき `"FizzBuzz"`  
- それ以外は数値そのもの  

出力例：  
```python
1
2
Fizz
4
Buzz
Fizz
7
8
Fizz
Buzz
11
Fizz
13
14
FizzBuzz
16
17
...
```

```{note}
**課題2**  

1から100までの整数の中で，  
- 偶数かつ3の倍数の個数
- 奇数かつ5の倍数の個数  

をそれぞれ数えて出力せよ．
```

```{note}
**おまけ（時間が余った人）**

整数`n`を入力し，次のルールに基づいて`n`を繰り返し更新し，毎回`n`を表示せよ：

- `n`が偶数なら`n = n / 2`とする．
- `n`が奇数なら`n = 3n + 1`とする．
- `n`が1になったらループを終了する．

※ この手続きによって得られる数列を<span style="color:red">コラッツ数列</span>と呼ぶ．
```

